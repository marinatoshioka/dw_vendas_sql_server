CREATE PROCEDURE USP_FULL_D_PRODUTO

AS

--CRIA TABELA CASO NAO EXISTA

IF OBJECT_ID('D_PRODUTO') IS NULL

BEGIN

CREATE TABLE D_PRODUTO
(
	COD_PRODUTO NUMERIC(15) PRIMARY KEY,
	DESCRICAO VARCHAR(100), 
	DESCRICAO_REDUZIDA VARCHAR(60),
	FAMILIA_PRODUTO VARCHAR(80),
	SECAO_PRODUTO VARCHAR(80),
	GRUPO_PRODUTO  VARCHAR(80),
	SUBGRUPO_PRODUTO  VARCHAR(80),
	MARCA  VARCHAR(80)



)
END



--LIMPA DADOS DA DIMENSAO
TRUNCATE TABLE D_PRODUTO


--POPULA TABELA DIMENSAO

INSERT INTO D_PRODUTO

SELECT * FROM
PROCFIT_ST.DBO.VW_D_PRODUTOS

